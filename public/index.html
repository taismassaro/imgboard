<!DOCTYPE html>
<html>
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <!-- <link href="https://fonts.googleapis.com/css?family=Montserrat:300,400,700,900&display=swap" rel="stylesheet"> -->
        <link
            href="https://fonts.googleapis.com/css?family=Poppins:300,400,700|Varela+Round&display=swap"
            rel="stylesheet"
        />
        <link rel="stylesheet" href="/css/normalize.css" />
        <link rel="stylesheet" href="/css/style.css" />
        <script src="https://kit.fontawesome.com/4647f9cbe3.js"></script>
        <title>img_src - Image Board Single-Page Application</title>
    </head>
    <body>
        <header>
            <div id="logo"><span><a href="/">img</a></span>_src</div>
        </header>
        <main>
            <!-- UPLOAD IMAGE FORM -->
            <section>
                <form autocomplete="off">
                    <input
                        v-model="form.title"
                        type="text"
                        name="title"
                        placeholder="title"
                        required
                    />
                    <input
                        v-model="form.description"
                        type="text"
                        name="description"
                        placeholder="description"
                        required
                    />
                    <input
                        v-model="form.username"
                        type="text"
                        name="username"
                        placeholder="username"
                        required
                    />

                    <input
                        @change="uploadFile"
                        type="file"
                        name="file"
                        id="file"
                        accept="image/*"
                        required
                    />
                    <label for="file"
                        ><i class="fas fa-plus"></i> {{uploaded}}</label
                    >
                    <input
                        v-model="form.tags"
                        type="text"
                        name="tags"
                        placeholder="tags"
                    />
                    <button @click="uploadImg">go</button>
                </form>
            </section>

            <!-- RENDER ALL IMAGES ON PAGE -->
            <section>
                <div v-if="tag">
                    <h1>Images with tag {{tag}}</h1>
                </div>
                <div id="img-container" v-if="images.length > 0">
                    <div class="card" v-for="img in images" :key="img.url">
                        <a :href="'#' + img.id">OPEN</a>
                        <img :src="img.url" :alt="img.title" />
                        <p>{{img.title}}</p>
                    </div>
                </div>
            </section>

            <!-- VUE COMPONENT -->
            <img-modal
                v-if="showModal"
                :img-id="imgId"
                :show-modal="showModal"
                @hide="hideModal"
            >
            </img-modal>
            <!-- VUE COMPONENT -->
        </main>

        <!-- VUE COMPONENT TEMPLATE -->
        <script id="modal-template" type="text/x-template">
            <div class="overlay" @click="hideModal">

                <!-- ERROR MESSAGE FOR NO IMAGE -->
                <template v-if="error === 'no image'">
                    <div class="modal">
                    <p>Oops, this image doesn't exist.</p>
                </div>
                </template>

                <!-- IMAGE MODAL -->
                <div class="modal" @click.stop v-else>

                <!-- IMAGE DATA -->
                <div id="modal-img">
                    <p @click="hideModal">X</p>
                    <p><span @click="showNext" v-if="currentImg.nextId"><</span><span @click="showPrev" v-if="currentImg.prevId">></span></p>
                    <img :src="currentImg.url">
                    <h1 class="modal-title">{{currentImg.title}}</h1>
                    <p class="modal-author">by <strong>{{currentImg.username}}</strong> <span>{{currentImg.created_at}}</span></p>
                    <p class="modal-description">{{currentImg.description}}</p>
                </div>

                <!-- SHOW TAGS UNDER IMAGE -->
                <div id="tags" v-if="tags.length > 0">
                    <div
                        v-for="tag in tags"
                    >
                        <p @click="selectTag(tag)" class="modal-tag">{{tag}}</p>
                    </div>
                </div>

                <!-- COMMENTS SECTION -->
                <div id="modal-comments">

                    <!-- ADD COMMENT FORM -->
                    <form>
                        <input
                            v-model="form.username"
                            type="text"
                            name="username"
                            placeholder="username" required
                        />
                        <!-- <label for="comment">Comment:</label> -->
                        <textarea
                            v-model="form.comment"
                            id="comment"
                            name="comment"
                            rows="4" cols="42"
                        >Comment away!</textarea>
                        <button @click="sendComment">comment</button>
                    </form>

                    <!-- RENDER ALL COMMENTS -->
                    <div id="comments" v-if="comments.length > 0">
                        <div
                            v-for="comment in comments"
                        >
                            <p class="modal-comment">{{comment.comment}}</p>
                            <p class="modal-author"><strong>{{comment.username}}</strong> <span>{{comment.date}}</span></p>
                        </div>
                    </div>
                </div>
                </div>
            </div>
        </script>
        <!-- VUE COMPONENT TEMPLATE -->

        <footer>
            A (not so safe) single-page application where anybody can go and
            upload an image of their choice.<br />Made with
            <span><i class="fas fa-heart"></i></span> and
            <a href="https://vuejs.org/" target="_blank">Vue.js</a> by
            <a href="https://github.com/taismassaro" target="_blank"
                >Ta√≠s Massaro</a
            ><br />@
            <a
                href="https://www.spiced-academy.com/program/full-stack-web-development/"
                target="_blank"
                >SPICED Academy</a
            >, 2019.
        </footer>
    </body>
    <script src="/js/vue.js"></script>
    <script src="/js/axios.min.js"></script>
    <script src="/js/script.js" charset="utf-8"></script>
</html>
